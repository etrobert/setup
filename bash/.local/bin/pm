#!/bin/sh

# Universal package manager - detects npm/yarn/pnpm and runs appropriate command

detect_package_manager() {
  if [ -f "pnpm-lock.yaml" ]; then
    echo "pnpm"
  elif [ -f "yarn.lock" ]; then
    echo "yarn"
  elif [ -f "package-lock.json" ]; then
    echo "npm"
  elif [ -f "package.json" ]; then
    # Default to npm if only package.json exists
    echo "npm"
  else
    echo "none"
  fi
}

main() {
  pm=$(detect_package_manager)

  if [ "$pm" = "none" ]; then
    echo "No package.json found in current directory"
    exit 1
  fi

  echo "Using $pm..."

  # Execute the command with the detected package manager
  exec "$pm" "$@"
}

main "$@"
