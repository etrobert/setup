#!/usr/bin/env bash

set -e

DIRECTION=$1

if [ -z "$DIRECTION" ]; then
  echo "Usage: brightness-control [up|down]"
  exit 1
fi

# Get focused monitor name
FOCUSED_MONITOR=$(hyprctl monitors -j | jq -r '.[] | select(.focused == true) | .name')

case "$FOCUSED_MONITOR" in
eDP-*)
  # Laptop display - use brightnessctl
  if [ "$DIRECTION" = "up" ]; then
    brightnessctl -e4 -n2 set 5%+
  elif [ "$DIRECTION" = "down" ]; then
    brightnessctl -e4 -n2 set 5%-
  fi
  ;;
*)
  # External monitor - use ddcutil with bus number for speed
  if [ "$DIRECTION" = "up" ]; then
    ddcutil setvcp 10 + 10 --noverify
  elif [ "$DIRECTION" = "down" ]; then
    ddcutil setvcp 10 - 10 --noverify
  fi
  ;;
esac
